#!/bin/bash

# Pandoc 转换测试脚本

echo "=== Pandoc Markdown 转 Word 测试 ==="
echo ""

# 创建测试 Markdown 文件
TEST_MD="report-result/test_report.md"
TEST_DOCX="report-result/test_report.docx"

echo "1. 创建测试 Markdown 文件..."
cat > "$TEST_MD" << 'EOF'
# 测试报告

## 📊 执行摘要

这是一个测试报告，用于验证 Pandoc 转换功能。

### 核心发现
- 发现1：数据完整性良好
- 发现2：趋势稳定上升
- 发现3：无异常波动

## 📈 数据概览

### 查询说明
- **分析问题**：查询各部门的销售额
- **SQL 查询**：`SELECT dept_name, SUM(sales_amount) FROM sales GROUP BY dept_name;`
- **数据范围**：2024年全年

### 关键指标

| 部门 | 销售额（万元） | 占比 |
|------|--------------|------|
| 销售部 | 1250.5 | 35% |
| 技术部 | 980.2 | 28% |
| 运营部 | 750.8 | 21% |
| 其他 | 568.5 | 16% |

## 🔍 详细分析

### 1. 销售表现分析

**数据表现**：销售部表现最佳，销售额达到 1250.5 万元，占总销售额的 35%。

**深层洞察**：
- 销售部业绩突出，主要得益于新产品线的推广
- 技术部虽然占比较低，但增长趋势明显
- 运营部需要进一步优化销售策略

**对比分析**：
- 同比增长：15.3%
- 环比增长：8.7%
- 行业平均增长：12.1%

### 2. 趋势预测

基于当前数据，预计：
- **Q1 2025**：销售额将增长 10-12%
- **上半年**：预计达到 2000 万元
- **全年**：有望突破 4000 万元

## 💡 关键发现

1. **发现1**：销售部是主要增长引擎，需持续投入资源
2. **发现2**：技术部潜力巨大，建议加强市场推广
3. **发现3**：运营部存在改进空间，需优化流程

## 💼 业务建议

### 立即行动项
1. **加强销售部培训**：提升团队整体能力，预期提升业绩 5-8%
2. **优化技术部产品线**：聚焦高价值产品，预期增长 12-15%

### 中长期规划
1. **战略调整**：向高附加值业务转型
2. **数字化转型**：引入 AI 辅助决策系统

### 监控指标
- 月度销售额：关注异常波动
- 客户满意度：确保服务质量
- 市场份额：保持竞争优势

## 📝 总结

本次分析显示，公司整体销售态势良好，销售部表现突出。建议持续关注技术部的增长潜力，同时优化运营部的销售策略，以实现全面均衡发展。

---

**报告生成时间**：2025-10-14  
**数据来源**：销售数据库  
**分析工具**：AI Report System
EOF

echo "✅ 测试文件创建成功: $TEST_MD"
echo ""

echo "2. 使用 Pandoc 转换为 Word..."
/opt/homebrew/bin/pandoc "$TEST_MD" -o "$TEST_DOCX" --standalone

if [ $? -eq 0 ]; then
    echo "✅ 转换成功！"
    echo ""
    echo "文件信息："
    ls -lh "$TEST_MD" "$TEST_DOCX"
    echo ""
    echo "📄 Markdown 文件: $TEST_MD"
    echo "📄 Word 文件: $TEST_DOCX"
    echo ""
    echo "可以使用以下命令打开 Word 文档："
    echo "open $TEST_DOCX"
else
    echo "❌ 转换失败！"
    exit 1
fi

echo ""
echo "=== 测试完成 ==="

