#!/bin/bash

# Pandoc è½¬æ¢æµ‹è¯•è„šæœ¬

echo "=== Pandoc Markdown è½¬ Word æµ‹è¯• ==="
echo ""

# åˆ›å»ºæµ‹è¯• Markdown æ–‡ä»¶
TEST_MD="report-result/test_report.md"
TEST_DOCX="report-result/test_report.docx"

echo "1. åˆ›å»ºæµ‹è¯• Markdown æ–‡ä»¶..."
cat > "$TEST_MD" << 'EOF'
# æµ‹è¯•æŠ¥å‘Š

## ðŸ“Š æ‰§è¡Œæ‘˜è¦

è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æŠ¥å‘Šï¼Œç”¨äºŽéªŒè¯ Pandoc è½¬æ¢åŠŸèƒ½ã€‚

### æ ¸å¿ƒå‘çŽ°
- å‘çŽ°1ï¼šæ•°æ®å®Œæ•´æ€§è‰¯å¥½
- å‘çŽ°2ï¼šè¶‹åŠ¿ç¨³å®šä¸Šå‡
- å‘çŽ°3ï¼šæ— å¼‚å¸¸æ³¢åŠ¨

## ðŸ“ˆ æ•°æ®æ¦‚è§ˆ

### æŸ¥è¯¢è¯´æ˜Ž
- **åˆ†æžé—®é¢˜**ï¼šæŸ¥è¯¢å„éƒ¨é—¨çš„é”€å”®é¢
- **SQL æŸ¥è¯¢**ï¼š`SELECT dept_name, SUM(sales_amount) FROM sales GROUP BY dept_name;`
- **æ•°æ®èŒƒå›´**ï¼š2024å¹´å…¨å¹´

### å…³é”®æŒ‡æ ‡

| éƒ¨é—¨ | é”€å”®é¢ï¼ˆä¸‡å…ƒï¼‰ | å æ¯” |
|------|--------------|------|
| é”€å”®éƒ¨ | 1250.5 | 35% |
| æŠ€æœ¯éƒ¨ | 980.2 | 28% |
| è¿è¥éƒ¨ | 750.8 | 21% |
| å…¶ä»– | 568.5 | 16% |

## ðŸ” è¯¦ç»†åˆ†æž

### 1. é”€å”®è¡¨çŽ°åˆ†æž

**æ•°æ®è¡¨çŽ°**ï¼šé”€å”®éƒ¨è¡¨çŽ°æœ€ä½³ï¼Œé”€å”®é¢è¾¾åˆ° 1250.5 ä¸‡å…ƒï¼Œå æ€»é”€å”®é¢çš„ 35%ã€‚

**æ·±å±‚æ´žå¯Ÿ**ï¼š
- é”€å”®éƒ¨ä¸šç»©çªå‡ºï¼Œä¸»è¦å¾—ç›ŠäºŽæ–°äº§å“çº¿çš„æŽ¨å¹¿
- æŠ€æœ¯éƒ¨è™½ç„¶å æ¯”è¾ƒä½Žï¼Œä½†å¢žé•¿è¶‹åŠ¿æ˜Žæ˜¾
- è¿è¥éƒ¨éœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–é”€å”®ç­–ç•¥

**å¯¹æ¯”åˆ†æž**ï¼š
- åŒæ¯”å¢žé•¿ï¼š15.3%
- çŽ¯æ¯”å¢žé•¿ï¼š8.7%
- è¡Œä¸šå¹³å‡å¢žé•¿ï¼š12.1%

### 2. è¶‹åŠ¿é¢„æµ‹

åŸºäºŽå½“å‰æ•°æ®ï¼Œé¢„è®¡ï¼š
- **Q1 2025**ï¼šé”€å”®é¢å°†å¢žé•¿ 10-12%
- **ä¸ŠåŠå¹´**ï¼šé¢„è®¡è¾¾åˆ° 2000 ä¸‡å…ƒ
- **å…¨å¹´**ï¼šæœ‰æœ›çªç ´ 4000 ä¸‡å…ƒ

## ðŸ’¡ å…³é”®å‘çŽ°

1. **å‘çŽ°1**ï¼šé”€å”®éƒ¨æ˜¯ä¸»è¦å¢žé•¿å¼•æ“Žï¼Œéœ€æŒç»­æŠ•å…¥èµ„æº
2. **å‘çŽ°2**ï¼šæŠ€æœ¯éƒ¨æ½œåŠ›å·¨å¤§ï¼Œå»ºè®®åŠ å¼ºå¸‚åœºæŽ¨å¹¿
3. **å‘çŽ°3**ï¼šè¿è¥éƒ¨å­˜åœ¨æ”¹è¿›ç©ºé—´ï¼Œéœ€ä¼˜åŒ–æµç¨‹

## ðŸ’¼ ä¸šåŠ¡å»ºè®®

### ç«‹å³è¡ŒåŠ¨é¡¹
1. **åŠ å¼ºé”€å”®éƒ¨åŸ¹è®­**ï¼šæå‡å›¢é˜Ÿæ•´ä½“èƒ½åŠ›ï¼Œé¢„æœŸæå‡ä¸šç»© 5-8%
2. **ä¼˜åŒ–æŠ€æœ¯éƒ¨äº§å“çº¿**ï¼šèšç„¦é«˜ä»·å€¼äº§å“ï¼Œé¢„æœŸå¢žé•¿ 12-15%

### ä¸­é•¿æœŸè§„åˆ’
1. **æˆ˜ç•¥è°ƒæ•´**ï¼šå‘é«˜é™„åŠ å€¼ä¸šåŠ¡è½¬åž‹
2. **æ•°å­—åŒ–è½¬åž‹**ï¼šå¼•å…¥ AI è¾…åŠ©å†³ç­–ç³»ç»Ÿ

### ç›‘æŽ§æŒ‡æ ‡
- æœˆåº¦é”€å”®é¢ï¼šå…³æ³¨å¼‚å¸¸æ³¢åŠ¨
- å®¢æˆ·æ»¡æ„åº¦ï¼šç¡®ä¿æœåŠ¡è´¨é‡
- å¸‚åœºä»½é¢ï¼šä¿æŒç«žäº‰ä¼˜åŠ¿

## ðŸ“ æ€»ç»“

æœ¬æ¬¡åˆ†æžæ˜¾ç¤ºï¼Œå…¬å¸æ•´ä½“é”€å”®æ€åŠ¿è‰¯å¥½ï¼Œé”€å”®éƒ¨è¡¨çŽ°çªå‡ºã€‚å»ºè®®æŒç»­å…³æ³¨æŠ€æœ¯éƒ¨çš„å¢žé•¿æ½œåŠ›ï¼ŒåŒæ—¶ä¼˜åŒ–è¿è¥éƒ¨çš„é”€å”®ç­–ç•¥ï¼Œä»¥å®žçŽ°å…¨é¢å‡è¡¡å‘å±•ã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**ï¼š2025-10-14  
**æ•°æ®æ¥æº**ï¼šé”€å”®æ•°æ®åº“  
**åˆ†æžå·¥å…·**ï¼šAI Report System
EOF

echo "âœ… æµ‹è¯•æ–‡ä»¶åˆ›å»ºæˆåŠŸ: $TEST_MD"
echo ""

echo "2. ä½¿ç”¨ Pandoc è½¬æ¢ä¸º Word..."
/opt/homebrew/bin/pandoc "$TEST_MD" -o "$TEST_DOCX" --standalone

if [ $? -eq 0 ]; then
    echo "âœ… è½¬æ¢æˆåŠŸï¼"
    echo ""
    echo "æ–‡ä»¶ä¿¡æ¯ï¼š"
    ls -lh "$TEST_MD" "$TEST_DOCX"
    echo ""
    echo "ðŸ“„ Markdown æ–‡ä»¶: $TEST_MD"
    echo "ðŸ“„ Word æ–‡ä»¶: $TEST_DOCX"
    echo ""
    echo "å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰“å¼€ Word æ–‡æ¡£ï¼š"
    echo "open $TEST_DOCX"
else
    echo "âŒ è½¬æ¢å¤±è´¥ï¼"
    exit 1
fi

echo ""
echo "=== æµ‹è¯•å®Œæˆ ==="

